<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-12-16 木 13:21 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>入門統計学 第6章 仮説検定と検出力</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="suzuki@iwate-u.ac.jp 鈴木正幸，非常勤講師" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://wiki.cis.iwate-u.ac.jp/~suzuki/org-html-theme/styles/bigblow/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/bigblow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
<div id="content">
<h1 class="title">入門統計学 第6章 仮説検定と検出力</h1>
<p>
入門統計学-第6章のスライドから
</p>

<div id="outline-container-org88c745d" class="outline-2">
<h2 id="org88c745d">(本章と次章で)仮説検定を学ぶと何を検証できる?</h2>
<div class="outline-text-2" id="text-org88c745d">
<ul class="org-ul">
<li>病気かどうかの判断</li>
<li>薬の効き目の有無</li>
<li>機械導入効果の有無</li>
<li>特定の値と標本平均を比較したり，</li>
<li>処理前後の 標本平均を比較することで，
その背後にある母集団の平にも差があるか否かを判定できる</li>
<li>平均だけで なく分散なども比較できる</li>
</ul>
</div>

<div id="outline-container-org83f8016" class="outline-3">
<h3 id="org83f8016">仮説検定の長所</h3>
<div class="outline-text-3" id="text-org83f8016">
<ul class="org-ul">
<li><p>
点推定や区間推定は，あくまで推 定量や誤差を数値で表すだけ
</p>

<p>
統計学を学んでない人にはわかりにくい
</p></li>

<li><p>
仮説検定ならば「処理の効果がある!」とはっきりいえるため，
</p>

<p>
誰にでもわかりやすく伝えられるで，結局，この薬は効くの かしら?  白黒
はっきりして，わかりやす い!
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgbc97166" class="outline-3">
<h3 id="orgbc97166">仮説検定と検出力</h3>
<div class="outline-text-3" id="text-orgbc97166">
<p>
仮説検定:母集団に対して主張したくない 仮説(処理の効果がない等)を立て，その 仮説が間違いであることを，実験結果の起 き難ささから判断する。
検出力:母集団の特性に差があるときに， ちゃんと“差がある”と判断できる能力。検定 の性能を表す指標で近年重視されている。
</p>
</div>
</div>
</div>

<div id="outline-container-org33c28f5" class="outline-2">
<h2 id="org33c28f5">6.1 検定の概要</h2>
<div class="outline-text-2" id="text-org33c28f5">
<ol class="org-ol">
<li>仮説の設定:つまらない仮説(帰無仮説)を立てる</li>
<li>検定統計量の計算:実験データから求める</li>
<li>確率の計算:実験結果の起こりやすさ(確率)を求める</li>
<li>仮説の判定
<ul class="org-ul">
<li><p>
4.1 仮説は正しい
</p>

<p>
よく起きることが起きただけ
</p></li>

<li><p>
4.2 仮説は間違い
</p>

<p>
滅多にしか起きないことが起きたので
棄却
</p></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org03733f8" class="outline-2">
<h2 id="org03733f8">仮説検定の大まかな手順</h2>
<div class="outline-text-2" id="text-org03733f8">
<dl class="org-dl">
<dt>手順1 仮説の設定</dt><dd>母集団における未知の事実を説明するため，とりあえず正しいものと仮定し
ておく道筋を立てる</dd>

<dt>手順2 検定統計量の計算</dt><dd>観測されたデータのままでは検定できるこ とは少ないので，目的に沿った
検定のため の統計量を求める (ただし，本章ではこの手順をスキップでき
る基本的な検定から解説する)</dd>

<dt>手順3 確率の計算</dt><dd><p>
  仮説が正しい下での実験結果の起こりやすさ(確率)を計算。
</p>

<p>
実際には，確率計算は難しいので，仮説の分布のどれぐらい端の方に位置し
ているのかで仮説の是非を判定
</p></dd>

<dt>手順4 仮説の判定</dt><dd><ul class="org-ul">
<li><p>
滅多に起きないことが起きたといえるぐらい確率が低いならば，
</p>

<p>
そもそもの仮説が間違いだったと判断。
</p></li>

<li><p>
そうでなければ判定を保留する
</p>

<p>
(仮説が正し かったとはいわない)
</p></li>
</ul></dd>
</dl>
</div>
</div>


<div id="outline-container-orgeeafc09" class="outline-2">
<h2 id="orgeeafc09">6.2 仮説の設定  (手順1の説明から)</h2>
<div class="outline-text-2" id="text-orgeeafc09">
<p>
母集団に立てる仮説には， * 帰無仮説 (H0) *と * 対立仮説 (H1) *の2つがある
</p>

<ul class="org-ul">
<li>基本となるのは帰無仮説で，帰無仮説が棄却されたときに採択する仮説が対立
仮説</li>
</ul>

<p>
帰無仮説は「主張したい内容とは逆の，つまらない内容」とする
</p>

<dl class="org-dl">
<dt>例</dt><dd><p>
処理効果が無い (2群の母平均に差は無い)
</p>

<p>
なぜ主張したい内容としないのだろうか?
</p></dd>
</dl>
</div>

<div id="outline-container-orgee3a2ef" class="outline-3">
<h3 id="orgee3a2ef">帰無仮説の内容</h3>
<div class="outline-text-3" id="text-orgee3a2ef">
<dl class="org-dl">
<dt>例</dt><dd><p>
殺虫剤の効果を検定する場合
</p>

<p>
主張したいのは「使用効果がある (使用前後で害虫数に差がある)」という内
容だが&#x2026;
</p>

<p>
それを検証するためには「*匹減る」と具体的にわかってなけれならない (無
限に設定できる)
</p>

<p>
使用効果がない(全く減らない)としておけば，それと矛盾した結果が観測さ
れれば，効果があるといえる (* 背理法 *)
</p></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgabb4b1d" class="outline-2">
<h2 id="orgabb4b1d">6.3 (1標本の)母平均の検定 </h2>
<div class="outline-text-2" id="text-orgabb4b1d">
<p>
検定統計量が不要(容易)な検定から学びます
</p>

<ul class="org-ul">
<li>特定の既知の値と観測された標本平均とを比較し，

<ul class="org-ul">
<li>その差が偶然(誤差)の範囲内なのか，</li>

<li>母集団においても差があるといえるほど大きい差なのかを判定する</li>
</ul></li>

<li><p>
普遍的なことをいうために, 母平均を考える
</p>

<p>
標本平均は，あくまでも標本
</p></li>

<li>比較対象が与えられているので，検定が簡単 (離れ具合が (既知) 比較 わかりやすい)</li>
</ul>
</div>


<div id="outline-container-orgb98205a" class="outline-3">
<h3 id="orgb98205a">母平均の検定の適用例</h3>
<div class="outline-text-3" id="text-orgb98205a">
<ul class="org-ul">
<li>病気の疑いのあるグループの平均と正常値とを比較して，病気か健康かを判
定</li>

<li>製造している商品の容量が袋に表記されている基準値と異なっていないかを
確認</li>

<li>調査した農家の平 均年齢が真の値からズレていないかを検証</li>
</ul>
</div>
</div>

<div id="outline-container-orgd549087" class="outline-3">
<h3 id="orgd549087">検定の原理</h3>
<div class="outline-text-3" id="text-orgd549087">
<p>
分布の母平均 μ を仮定，標本平均 \( \overline{X}_{n} \) を計算
</p>

<p>
真の値なので，よく 起きる(確率が高い)
</p>

<p>
滅多に起きない区間
</p>

<ul class="org-ul">
<li><p>
実験結果が両端に来たら，こ の分布は真の分布ではない
</p>

<p>
実験結果の平均値が両端に位 置するならば，この分布ではなく 別の分布に
従っていると考える
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org2c38af1" class="outline-3">
<h3 id="org2c38af1">ステップ1:2つの仮説を考える</h3>
<div class="outline-text-3" id="text-org2c38af1">
<dl class="org-dl">
<dt>帰無仮説 H0:μ=μ0</dt><dd>同じ母集団から抽出 (μ0は𝑥 ̄ の真の値)</dd>
<dt>対立仮説 H1:μ≠μ0</dt><dd>異なる母集団から抽出 (μ0は𝑥 ̄ の真の値ではない)</dd>
</dl>
</div>

<div id="outline-container-orgc460301" class="outline-4">
<h4 id="orgc460301">対立仮説の内容は3種類</h4>
<div class="outline-text-4" id="text-orgc460301">
<p>
普通はどち らが大きいかはわからないため，両側検定を基本とする
</p>

<dl class="org-dl">
<dt>パターン1 μ≠μ0</dt><dd><p>
両側検定
</p>

<p>
どちらが大きくなるかは不明 (とにかく差があることに興味がある)
</p></dd>

<dt>パターン2 :μ&lt;μ0 </dt><dd><p>
片側検定
</p>

<p>
比較値μ0が標本の母平均μより も大きいと仮定できる (あるいは比較値の
方が小さいことには興味がない)
</p></dd>

<dt>パターン3 μ&gt;μ0</dt><dd><p>
片側検定
</p>

<p>
比較値μ0が標本の母平均μより も小さいと仮定できる(あるいは比較値の
方が大きいこ片側検定の方が差があることをいいやすいが，と
には興味がない)
</p></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orga7d2444" class="outline-3">
<h3 id="orga7d2444">ステップ2: 帰無仮説が正しい場合の  標本の位置は?</h3>
<div class="outline-text-3" id="text-orga7d2444">
<ul class="org-ul">
<li>μ0を真の値とした母集団から抽出した標本分布(比較対象)</li>
<li>μを真の値とした母集団から抽出した標本分布 (観測された標本の分布)</li>
</ul>


<dl class="org-dl">
<dt>棄却域</dt><dd>離れた値をとるならば帰 無仮説が間違っている 可能性が高い</dd>

<dt>帰無仮説の受容域</dt><dd>帰無仮説が正しいなら， 標本平均は比較値μ0と近い値を取りやすい</dd>
</dl>
</div>
</div>

<div id="outline-container-org38a3a13" class="outline-3">
<h3 id="org38a3a13">ステップ2:  帰無仮説が間違っている場合は?</h3>
<div class="outline-text-3" id="text-org38a3a13">
<dl class="org-dl">
<dt>帰無仮説の分布</dt><dd>μ0を真の値とした標本分布 (比較対象)</dd>

<dt>対立仮説の分布</dt><dd>μを真の値とした標本分布 (観測された標本分布)</dd>
</dl>

<p>
異なる母集団から抽出されたので標本分布も離れている
</p>

<p>
帰無仮説が間違っているなら，標本平均はμ0と離れた値を取りやすい
</p>

<p>
どれぐらい離れていれば帰無仮説は間違い?
</p>
</div>
</div>

<div id="outline-container-org7117827" class="outline-3">
<h3 id="org7117827">ステップ3: どこから帰無仮説を棄却する?</h3>
<div class="outline-text-3" id="text-org7117827">
<ul class="org-ul">
<li>任意の有意水準 (一般的にα=5%とする)</li>
<li>に対応する値を基準(限界値)として，</li>
<li>帰無仮説の是非を判定</li>
</ul>
</div>
</div>

<div id="outline-container-org500db44" class="outline-3">
<h3 id="org500db44">ステップ4: 検定統計量(観測された標本平均)と比較する</h3>
<div class="outline-text-3" id="text-org500db44">
<p>
正規分布 (中心極限定理より)
有意水準α/ 2=0.025
有意水準α/ 2=0.025
     帰無仮説の分布
    母標準誤差(標本平
均𝑥 ̄ の母標準偏差) μ0
𝑥 ̄
μ0 −1.96σx 受容
𝑥 ̄
𝑥 ̄ 棄却
   μ0 ±1.96σx z分布表から上側確率が
0.025になるz値を読み取る (区間推定と同じ)
μ0 +1.96σx
 これぐらいの差ならば 偶然に観測されるこ とがある(帰無仮説は 間違いとはいえない)
滅多に起きないぐらいの 大きな差なので，別の分 布に従う(帰無仮説は間 違い)→有意差がある
</p>
</div>
</div>


<div id="outline-container-orgac5b4be" class="outline-3">
<h3 id="orgac5b4be">ステップ4の補足: p値を使った検定法  (ソフトウェアが必要)</h3>
<div class="outline-text-3" id="text-orgac5b4be">
<p>
p値    𝑥 ̄ 実験で観測された標本平均
𝑥 ̄
(検定統計量)
p値:帰無仮説の下で，実験結果(検定統計量)よりも極端な値    が観測される確率 →p値を有意水準αと比較して“p&lt;α”ならば帰無仮説を棄却(有意)
</p>
</div>
</div>
</div>

<div id="outline-container-org30a201a" class="outline-2">
<h2 id="org30a201a">例 題</h2>
</div>

<div id="outline-container-orgaf647b9" class="outline-2">
<h2 id="orgaf647b9">6.5 検出力分析</h2>
<div class="outline-text-2" id="text-orgaf647b9">
<p>
1実施した検定の能力(検出力)はどのぐらいだったのかを 示すのが重要になってきている
2処理効果(2群の差)そのものの大きさ(効果量)を推定 することも重要になってきている
→こうした検出力や効果量を求めて検定の良し悪しを評価し たり，望ましい標本サイズを事前に決める分野を検出力分
析と総称
→検出力分析の基本は，検定における2種類の間違い(統計 的過誤)なので，まずはこれから解説
</p>
</div>

<div id="outline-container-org7a5ace8" class="outline-3">
<h3 id="org7a5ace8">統計的過誤は</h3>
<div class="outline-text-3" id="text-org7a5ace8">
<p>
標本を用いている以上，仮説検定で間違った判断(統計的 過誤)を下してしまうこともある
第一種の過誤:処理効果(群間で差)が無いのに有ると判 断してしまう間違い→帰無仮説が真なのに棄却してしまう過 ち(確率はαで表す)
第二種の過誤:処理効果(差)が有るのに無いと判断して しまう間違い→帰無仮説が偽なのに棄却しない(真の対立 仮説を採択し損なう)過ち(β)
それぞれを図解すると&#x2026;
2
種類
</p>
</div>
</div>


<div id="outline-container-org7d2ae22" class="outline-3">
<h3 id="org7d2ae22">第一種の過誤 (TypeIerror)</h3>
<div class="outline-text-3" id="text-org7d2ae22">
<p>
 本当は差が無いのに こちらを採択 (差は有ると誤判定)
対立仮説の分布 (間違っている)
     限 界 値
α/2
帰無仮説の分布 (正しい)
限 界 値
α/2
      検定統計量が帰無仮説の 分布で端の値を取ると&#x2026;
これが有意水準(検定で許容 できる第一種の過誤の上限)
   この検定で帰無仮説が正しいの に棄却してしまう確率(危険率) →帰無仮説分布上の確率
</p>
</div>
</div>

<div id="outline-container-org3a2c39c" class="outline-3">
<h3 id="org3a2c39c">第二種の過誤 (TypeIIerror)</h3>
<div class="outline-text-3" id="text-org3a2c39c">
<p>
β
検定統計量が対立仮説の 分布で端の値を取ると&#x2026;
本当は差が有るのに こちらを採択できない (差はないと誤判定)
対立仮説の分布 (正しい)
限 界 値
  帰無仮説の分布 (間違っている)
      ここまでがβ
 この検定で帰無仮説が間違っ ているのに受容してしまう確率 →対立仮説分布上の確率
</p>
</div>
</div>

<div id="outline-container-org6458cbb" class="outline-3">
<h3 id="org6458cbb">第一種と第二種の過誤では どちらが重大(致命的)?</h3>
<div class="outline-text-3" id="text-org6458cbb">
<p>
例えば，効果が無い薬を売り出した場合(第一種過誤) と，効果が有る薬を開発したのに売り出せない場合(第二 種過誤)では，どちらが製薬会社にとって致命的なダメー ジとなるか?
 →第一種の過誤の方が致命的な事が多い  →その検定で許容できる第一種の過誤を犯す確率α(有意
 水準)を小さく設定するのが一般的
 →α=0.05は，実験と検定を100回実施しても5回までしか 過誤を許さないということ
</p>

<p>
)
</p>
</div>
</div>

<div id="outline-container-orgd8ab65d" class="outline-3">
<h3 id="orgd8ab65d">第二種の過誤の方が致命的な事例</h3>
<div class="outline-text-3" id="text-orgd8ab65d">
<p>
一旦，効果(差)を見逃してしまったら，取 り返しの付かない場合
 →下例で正しい対立仮説を採択し損ねたら? 事例1:環境保護政策の効果の検定
(H0:効果無し，H1:効果有り)→ 環境は一度破壊されたら二度と戻らな
い 事例2:食品添加物の毒性の検定(H0:
(あまりないですが&#x2026;
     毒性無し，H1:毒性有り)→毒の入っ
</p>
</div>
</div>

<div id="outline-container-orge7bd515" class="outline-3">
<h3 id="orge7bd515">第二種の過誤を抑えた検定はどうやる?</h3>
<div class="outline-text-3" id="text-orge7bd515">
<p>
有意水準αのように，その検定で許容できる できない
</p>

<p>
第二種の過誤確率βを事前に設定すれば良い? 理由:対立仮説の分布の確率計算が難しいから
→帰無仮説分布からの離れ具合(非心度)によっ て対立仮説分布の形状が変わる(図を次掲)
→非心度は実質的な差(効果量)と標本サイズか ら決まるため，事前(検定前)に計算できない
→対立仮説を判定するためのβに対応する限界値は 不明(有意水準の限界値を便宜的に共有する)
</p>
</div>
</div>

<div id="outline-container-org6bd066b" class="outline-3">
<h3 id="org6bd066b">対立仮説の分布(非心分布)</h3>
<div class="outline-text-3" id="text-org6bd066b">
<p>
  t分布
非心t分布上の 確率計算は困難
対立仮説
非心t分布 (非心度によって形が変化)
    帰無仮説
 β
非心度
  (標本サイズと効果量によって決まり，zやt検定では検定統計量そのもの) 実質的な差の大きさなので事前には不明
注:自由度が関係ない(標準)正規分布の場合，対立仮説の分布でも形は不変
</p>
</div>
</div>

<div id="outline-container-org1932ed2" class="outline-3">
<h3 id="org1932ed2">効果量</h3>
<div class="outline-text-3" id="text-org1932ed2">
<p>
 (注:検定によって計算式は色々ある)
母集団が持つ処理効果そのもの(実質的な差)の大きさ 
  母平均の検 d=μ−μ0 定の効果量 未知 σ
標本の母平均μと比較値μ0の差が母標 準偏差σ(標準誤差ではないので標本サ
 イズとは無関係)の何倍なのかを示す →観測された標本から検定後に推定でき
る
検定統計量
母平均の検定 x−μ t
推定した効果量から非心度
ˆ
0
or     
d = 不偏標準偏差
を推定すれば，対立仮説分 n 布の確率βも計算できる
 の推定効果量
σˆ
</p>
</div>
</div>

<div id="outline-container-org6a54b9c" class="outline-3">
<h3 id="org6a54b9c">効果量を検定結果に加えよう!</h3>
<div class="outline-text-3" id="text-org6a54b9c">
<p>
検定は標本サイズに影響を受けるが，効果量は標 本サイズと関係ない
→検定結果が有意でなくても効果量が大きいことも ある(逆に，有意でも効果量が小さいこともあ
る)
→検定統計量を差(効果)の大きさと勘違いした り，有意でなかったときに処理が全く無意味と思
 われないように，推定効果量も書いておく
</p>

<p>
第二種の過誤が致命的な場合の対処法に戻って&#x2026;
</p>

<p>
   大きな標本サイズで
   非心度・小
βを抑える 非心度・大
                帰無仮説
対立仮説
β 2.5
標本サイズを 大きくすると&#x2026;
(効果量と αは同じ)
対立仮説
β 2.5
帰無仮説
    標本サイズの大きな実験を計画することで，βを小さくできる (任意のαの下で望ましいβになるような，おおよその標本 サイズを逆算して実験を計画すればよい→ソフトウェアを 使った標本サイズの決め方を最後に解説)
</p>
</div>
</div>

<div id="outline-container-org284afd5" class="outline-3">
<h3 id="org284afd5">第二種の過誤を抑えるもう一つの裏技</h3>
<div class="outline-text-3" id="text-org284afd5">
<p>
  αを大きくして
βを小さくする αを大きくすれば&#x2026;
  αとβで共用している限界 値(の絶対値)を小さくする
                  帰無仮説
対立仮説 βα/2
対立仮説 β α/2
(効果量と標本 サイズは同じ)
帰無仮説
   第一種の過誤が致命的でないなら，有意水準αの許容を大きくすること で，αとトレードオフ関係にあるβは小さくなる (ただし，よほどデータを集めるのが困難な場合を除いて用いられない)
</p>
</div>
</div>


<div id="outline-container-org48c18ae" class="outline-3">
<h3 id="org48c18ae">検出力</h3>
<div class="outline-text-3" id="text-org48c18ae">
<p>
 を使ってきましたが&#x2026;
第二種の過誤確率βよりも，その補数(1-β)である検出力を考え る方がわかりやすい →本当に処理効果(差)があるときに，「ある」といえる能力
  ここまで
 β
    限 界 値
限 界 値
β
対立仮説 (正しい)
  帰無仮説 (間違い)
検出力 (1-β)
    ここから下側も 検出力(1-β)
この検定で，正しい対立 仮説を採択できる確率
</p>
</div>
</div>

<div id="outline-container-org0766c11" class="outline-3">
<h3 id="org0766c11">検出力も検定結果に加えよう!</h3>
<div class="outline-text-3" id="text-org0766c11">
<p>
 検出力は，その検定の能力を表している
 p値や有意水準のみでは，正しい対立仮説を
 高い確率で採択し損なっていてもわからない
 事後(検定後)ならば計算できるので，検定
 結果に書いておくと良い
→非心分布の確率計算は難しいので，G*power などのソフトウェアが必要
</p>
</div>
</div>

<div id="outline-container-orgb7a8bdc" class="outline-3">
<h3 id="orgb7a8bdc">検出力の計算(事後分析)</h3>
<div class="outline-text-3" id="text-orgb7a8bdc">
<p>
  効果量d
標本サイズn
  検出力(1- β)
非心度 (対立仮説分布 の離れ具合)
βとトレードオフ
  検出力は3つの要素から決まる(これら3要素をパラ メータとして，ソフトウェアに入力すれば計算できる)
有意水準α
</p>
</div>
</div>

<div id="outline-container-org981ee27" class="outline-3">
<h3 id="org981ee27">ソフト(G*power)を使った検出力計算</h3>
<div class="outline-text-3" id="text-org981ee27">
<p>
   痛風の例題で推定してみると&#x2026;
 効果量は1.57，検出力は0.75
 母平均のt検定 事後分析(検出力の計算)
  非心度(zやt検定では検定統計量)
 計算された検出力
  比較値μ0
 標本平均� ̄
  3つのパラメータを入力
計算された効果量
不偏標準偏差σ^
</p>
</div>
</div>

<div id="outline-container-orgfde6cd2" class="outline-3">
<h3 id="orgfde6cd2">標本サイズの計算(事前分析)</h3>
<div class="outline-text-3" id="text-orgfde6cd2">
<p>
任意の有意水準の下で望ましい検出力になるような  標本サイズを事前に求める(効果量は予想するしかな
い)
    標本サイズn
効果量d
有意水準α 検出力(1-
β)
関連データがあれば推定し，なけ れば検定ごとに示されている目安 を使う(母平均の検定で0.2~0.8)
0.05(5%)がもっとも一般的
0.8(80%)程度で良いだろうと コーエンが提唱
</p>
</div>
</div>

<div id="outline-container-org22a27df" class="outline-3">
<h3 id="org22a27df">ソフト(G*power)を使った標本サイズの計算</h3>
<div class="outline-text-3" id="text-org22a27df">
<p>
  大きい効果量(0.8)が得られると予想されるな ら，一般的な有意水準(0.05)と検出力(0.8)
の検定を実現するための標本サイズは&#x2026;
 n=15
    効果量の目安
母平均のt検定 事前分析(標本サイズの計算)
計算された標本サイズ
注:第二種の過誤が致命的な場合は， 検出力か有意水準αを大きく設定する
   3つのパラメータを入力
</p>

<p>
以上で第6章は終了で
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: suzuki@iwate-u.ac.jp 鈴木正幸，非常勤講師</p>
<p class="date">Created: 2021-12-16 木 13:21</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
